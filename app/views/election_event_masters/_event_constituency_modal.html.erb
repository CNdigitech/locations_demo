<div id="district_form" class="w3-modal w3-animate-opacity" style="display: block">
    
<%= simple_form_for :constituency_data , :url => event_constituency_modal_path, :method => :get, html:{autocomplete:'off'} do |f| %>
    <%= f.input :constituency_id, label: false do  %>
        <div class="modal-dialog modal-dialog-scrollable" role="document">
            <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">District Selection</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span onclick="document.getElementById('district_form').style.display='none'"
                    >&times;</span>
                </button>
            </div>
            <div class="modal-body">               
                <table class="table table-striped table-condensed table-hover " id="con-table">
                    <thead class="w3-black">
                        <tr>
                            <th>District</th>
                            <th> Select</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% @region_ids.each do |region| %>
                            <% @constituencies = Constituency.where("region_id = ? AND active_status = true",region)%>
                            <% logger.info " This is the value === '#{@constituencies.inspect}' "%>
                            <% @constituencies.each_with_index  do |constituency,index| %>
                                <tr>
                                    <td><%= constituency.name %></td>
                                    <td>
                                        <label>
                                        <input name="constituency_data[constituency_id]" type="checkbox"  value="<%= constituency.id %>" />
                                        <span> </span>
                                        </label>
                                    </td>
                                </tr>
                            <% end %>
                        <% end %>
                    </tbody>
                </table>
                <input type="hidden" name="val" value="status"/>

            </div>
            <div class="modal-footer">
                <span onclick="document.getElementById('district_form').style.display='none'"
                 class="btn btn-md btn-secondary" >Close</span>
                 <button class=" btn btn-md btn-primary" id="polling-data">Next Step</button>


            </div>
            </div>
        </div>
    <% end %>
<% end %>

 
</div>



 <style>
    .bottom-btn{
      margin-top: 5%;
      /*margin-left: 55%;*/
    }
  </style>


  <script>

       $( "#polling-data" ).click(function() {
        var url = "<%= event_poll_station_modal_url %>";
        // var regions = [$("input[type=checkbox][name='region_data[region_id]']").val()];

        var constituencies =  $("#con-table input:checkbox:checked").map(function(){
                            return $(this).val();
                        }).get();
        console.log("we are here with constituency ids = "+constituencies);

        $.ajax({
            type: "GET",
            url: url,
            dataType: 'script',
            data: {
                constituency_id: constituencies
            }, // serializes the form's elements.
            success: function(data)
            {
                // $("#event_region_modal").html(data);
                // alert("success")
            }
        });
        return false;

    });

  </script>